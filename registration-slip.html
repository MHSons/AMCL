<!doctype html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Patient Slip - AlphaMed Clinical Laboratory</title>
  <link rel="stylesheet" href="style.css">
  <script src="qrcode.min.js"></script>
</head>
<body>

  <div class="report-header">
    <!-- QR Code Left -->
    <div id="qrcode"></div>
    <!-- Logo Right -->
    <img src="logo.png" alt="AlphaMed Logo">
    <h2 style="text-align:center; margin-top:60px;">AlphaMed Clinical Laboratory</h2>
    <h4 style="text-align:center;">Quality Assurance Through Advanced Technology</h4>
  </div>

  <div class="container">
    <h2>Patient Registration Slip</h2>
    <div id="slip-details"></div>
    <button onclick="window.print()" style="margin-top:20px;">ðŸ–¨ Print Slip</button>
  </div>

  <script>
    // Helper: get URL param
    function getParam(name){
      const url = new URL(window.location.href);
      return url.searchParams.get(name);
    }

    const id = getParam("id");
    const patients = JSON.parse(localStorage.getItem("patients") || "[]");
    const p = patients.find(x => x.id === id);

    if(p){
      document.getElementById("slip-details").innerHTML = `
        <p><b>Patient ID:</b> ${p.id}</p>
        <p><b>Name:</b> ${p.name}</p>
        <p><b>Age:</b> ${p.age} | <b>Gender:</b> ${p.gender}</p>
        <p><b>Department:</b> ${p.department}</p>
        <p><b>Tests:</b> ${p.tests.join(", ")}</p>
        <p><b>Date:</b> ${new Date(p.created).toLocaleString()}</p>
      `;

      // QR Code Generate
      new QRCode(document.getElementById("qrcode"), {
        text: `AlphaMed Clinical Laboratory
Patient ID: ${p.id}
Name: ${p.name}
Age: ${p.age}, Gender: ${p.gender}
Department: ${p.department}
Tests: ${p.tests.join(", ")}
Date: ${new Date(p.created).toLocaleString()}`,
        width: 100,
        height: 100
      });
    } else {
      document.getElementById("slip-details").innerHTML = "<p style='color:red;'>Invalid or missing patient record!</p>";
    }
  </script>

</body>
</html>
